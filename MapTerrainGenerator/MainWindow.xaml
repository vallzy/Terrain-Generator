<Window x:Class="MapTerrainGeneratorWPF.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Radiant Terrain Generator" Height="720" Width="950" WindowStartupLocation="CenterScreen">
    <DockPanel>
        <Menu DockPanel.Dock="Top" Background="White" BorderBrush="LightGray" BorderThickness="0,0,0,1">
            <MenuItem Header="_File">
                <MenuItem Header="Exit" Click="MenuExit_Click"/>
            </MenuItem>
            <MenuItem Header="_View">
                <MenuItem Header="Configuration" Click="MenuConfig_Click"/>
            </MenuItem>
            <MenuItem Header="_Help">
                <MenuItem Header="GitHub" Click="MenuGithub_Click"/>
            </MenuItem>
        </Menu>
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="29.892"/>
                <ColumnDefinition Width="25.992"/>
                <ColumnDefinition Width="424.116"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <Grid Grid.Column="0" Margin="20,20,20,20" Grid.ColumnSpan="3">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,15">
                    <Label Content="Target Mode:" Width="90" VerticalAlignment="Center" FontWeight="Bold"/>
                    <ComboBox x:Name="cmbTargetMode" Width="160" SelectedIndex="0" VerticalAlignment="Center" Padding="4" SelectionChanged="CmbTargetMode_SelectionChanged">
                        <ComboBoxItem Content="Use .map Hint Brush"/>
                        <ComboBoxItem Content="Manual Size"/>
                    </ComboBox>
                </StackPanel>

                <StackPanel x:Name="panelMapFile" Grid.Row="1" Orientation="Horizontal" Margin="0,0,0,15">
                    <Label Content="Map File:" Width="90" VerticalAlignment="Center" FontWeight="Bold"/>
                    <TextBox x:Name="txtFile" Width="260" VerticalAlignment="Center" Padding="4" TextChanged="TxtFile_TextChanged"/>
                    <Button x:Name="btnBrowse" Content="Browse" Width="70" Margin="10,0,0,0" Padding="4" Click="BtnBrowse_Click"/>
                </StackPanel>

                <StackPanel x:Name="panelManualSize" Grid.Row="2" Orientation="Horizontal" Visibility="Collapsed" Margin="0,0,0,15">
                    <Label Content="Width (X):" Width="70" VerticalAlignment="Center"/>
                    <TextBox x:Name="txtGenWidth" Width="60" Text="2048" Padding="4" TextChanged="UI_Changed"/>

                    <Label Content="Length (Y):" Width="70" Margin="15,0,0,0" VerticalAlignment="Center"/>
                    <TextBox x:Name="txtGenLength" Width="60" Text="2048" Padding="4" TextChanged="UI_Changed"/>

                    <Label Content="Height (Z):" Width="70" Margin="15,0,0,0" VerticalAlignment="Center"/>
                    <TextBox x:Name="txtGenHeight" Width="60" Text="256" Padding="4" TextChanged="UI_Changed"/>
                </StackPanel>

                <StackPanel Grid.Row="3" Orientation="Vertical" Margin="0,0,0,15">
                    <StackPanel Orientation="Horizontal" Margin="0,0,0,5">
                        <Label Content="Sub-square Size:" Width="120" VerticalAlignment="Center" FontWeight="Bold"/>
                        <ComboBox x:Name="cmbSubSquarePreset" Width="80" SelectedIndex="3" VerticalAlignment="Center" Padding="4" SelectionChanged="UI_Changed">
                            <ComboBoxItem Content="8"/>
                            <ComboBoxItem Content="16"/>
                            <ComboBoxItem Content="32"/>
                            <ComboBoxItem Content="64"/>
                            <ComboBoxItem Content="128"/>
                            <ComboBoxItem Content="256"/>
                            <ComboBoxItem Content="512"/>
                            <ComboBoxItem Content="1024"/>
                        </ComboBox>
                        <CheckBox x:Name="chkAdvancedSubSquare" Content="Advanced mode" VerticalAlignment="Center" Margin="15,0,0,0" Checked="ChkAdvancedSubSquare_Changed" Unchecked="ChkAdvancedSubSquare_Changed"/>
                    </StackPanel>

                    <StackPanel x:Name="panelAdvancedSubSquare" Orientation="Horizontal" Visibility="Collapsed" Margin="120,0,0,0">
                        <Label Content="X:" Width="20" VerticalAlignment="Center"/>
                        <TextBox x:Name="txtSizeX" Text="64" Width="50" VerticalAlignment="Center" Padding="4" TextChanged="UI_Changed"/>
                        <Label Content="Y:" Width="20" Margin="15,0,0,0" VerticalAlignment="Center"/>
                        <TextBox x:Name="txtSizeY" Text="64" Width="50" VerticalAlignment="Center" Padding="4" TextChanged="UI_Changed"/>
                        <Label Content="(Must be powers of 2)" Foreground="Gray" VerticalAlignment="Center" Margin="10,0,0,0"/>
                    </StackPanel>
                </StackPanel>

                <Label Content="Top Texture:" Grid.Row="4" Grid.Column="0" VerticalAlignment="Center" FontWeight="SemiBold"/>
                <DockPanel Grid.Row="4" Grid.Column="1" Margin="0,5">
                    <Button Content="Browse..." DockPanel.Dock="Right" Width="60" Margin="5,0,0,0" Click="BtnBrowseTopTexture_Click"/>
                    <TextBox x:Name="txtTexture" Text="textures/common/caulk" Padding="3" TextChanged="UI_Changed"/>
                </DockPanel>

                <StackPanel Grid.Row="5" Orientation="Horizontal" Margin="0,0,0,15">
                    <Label Content="Base Shape:" Width="90" VerticalAlignment="Center" FontWeight="Bold"/>
                    <ComboBox x:Name="cmbShapeType" Width="150" SelectedIndex="0" VerticalAlignment="Center" Padding="4" SelectionChanged="CmbShapeType_SelectionChanged">
                        <ComboBoxItem Content="Flat (None)"/>
                        <ComboBoxItem Content="Hill (Center Peak)"/>
                        <ComboBoxItem Content="Crater (Raised Edges)"/>
                        <ComboBoxItem Content="Ridge"/>
                        <ComboBoxItem Content="Slope"/>
                        <ComboBoxItem Content="Volcano (Peak + Crater)"/>
                        <ComboBoxItem Content="Valley (Center Dip)"/>
                        <ComboBoxItem Content="Tunnel"/>
                        <ComboBoxItem Content="Slope Tunnel"/>
                    </ComboBox>
                </StackPanel>

                <StackPanel x:Name="panelShapeHeight" Grid.Row="6" Orientation="Horizontal" Margin="0,0,0,15" Visibility="Collapsed">
                    <Label x:Name="lblShapeHeight" Content="Shape Height:" Width="90" VerticalAlignment="Center"/>
                    <TextBox x:Name="txtShapeHeight" Text="256" Width="60" VerticalAlignment="Center" Padding="4" TextChanged="UI_Changed"/>
                    <Label Content="(Max height of the macro shape)" Foreground="Gray" VerticalAlignment="Center"/>
                </StackPanel>

                <StackPanel x:Name="panelTunnelHeight" Grid.Row="7" Orientation="Horizontal" Margin="0,0,0,15" Visibility="Collapsed">
                    <Label Content="Tunnel Height:" Width="90" VerticalAlignment="Center"/>
                    <TextBox x:Name="txtTunnelHeight" Text="256" Width="60" VerticalAlignment="Center" Padding="4" TextChanged="UI_Changed"/>
                    <Label Content="(Height of the tunnel opening)" Foreground="Gray" VerticalAlignment="Center"/>
                </StackPanel>

                <StackPanel x:Name="panelTerrace" Grid.Row="8" Orientation="Horizontal" Margin="0,0,0,25" Visibility="Collapsed">
                    <Label Content="Terrace Step:" Width="90" VerticalAlignment="Center"/>
                    <TextBox x:Name="txtTerrace" Text="0" Width="60" VerticalAlignment="Center" Padding="4" TextChanged="UI_Changed"/>
                    <Label Content="(0 for smooth, e.g., 32 for stairs)" Foreground="Gray" VerticalAlignment="Center"/>
                </StackPanel>

                <StackPanel Grid.Row="9" Orientation="Horizontal" Margin="0,0,0,15">
                    <Label Content="Noise Type:" Width="90" VerticalAlignment="Center" FontWeight="Bold"/>
                    <ComboBox x:Name="cmbNoiseType" Width="150" SelectedIndex="0" VerticalAlignment="Center" Padding="4" SelectionChanged="UI_Changed">
                        <ComboBoxItem Content="Perlin Noise"/>
                        <ComboBoxItem Content="Simplex Noise"/>
                        <ComboBoxItem Content="Regular (Random)"/>
                    </ComboBox>
                </StackPanel>

                <StackPanel Grid.Row="10" Orientation="Horizontal" Margin="0,0,0,15">
                    <Label Content="Variance:" Width="90" VerticalAlignment="Center"/>
                    <TextBox x:Name="txtVariance" Text="32" Width="60" VerticalAlignment="Center" Padding="4" TextChanged="UI_Changed"/>
                    <Label Content="(Max offset of the rocky noise)" Foreground="Gray" VerticalAlignment="Center"/>
                </StackPanel>

                <StackPanel Grid.Row="11" Orientation="Horizontal" Margin="0,0,0,25">
                    <Label Content="Frequency:" Width="90" VerticalAlignment="Center"/>
                    <ComboBox x:Name="cmbFrequency" Width="150" IsEditable="True" Text="0.005 (Smooth)" VerticalAlignment="Center" Padding="4" SelectionChanged="UI_Changed" TextBoxBase.TextChanged="UI_Changed">
                        <ComboBoxItem Content="0.001 (Very Smooth)"/>
                        <ComboBoxItem Content="0.005 (Smooth)"/>
                        <ComboBoxItem Content="0.01 (Bumpy)"/>
                        <ComboBoxItem Content="0.05 (Chaotic)"/>
                    </ComboBox>
                </StackPanel>

                <StackPanel x:Name="panelMapName" Grid.Row="12" Orientation="Horizontal" Visibility="Collapsed" Margin="0,0,0,15">
                    <Label Content="Output Name:" Width="90" VerticalAlignment="Center" FontWeight="Bold"/>
                    <TextBox x:Name="txtMapName" Width="260" Text="terrain_output" VerticalAlignment="Center" Padding="4"/>
                    <Label Content=".map" VerticalAlignment="Center" Margin="5,0,0,0" Foreground="Gray"/>
                </StackPanel>

                <StackPanel Grid.Row="13" Orientation="Horizontal" Margin="0,0,0,15">
                    <Button x:Name="btnGenerate" Content="GENERATE" Width="110" Height="40" Background="#FFADD8E6" FontWeight="Bold" Click="BtnGenerate_Click" Margin="0,0,15,0"/>
                    <Button x:Name="btnExport" Content="EXPORT .MAP" Width="120" Height="40" Background="#FF90EE90" FontWeight="Bold" Click="BtnExport_Click" IsEnabled="False"/>
                    <CheckBox x:Name="chkOverrideMap" Content="Override map" VerticalAlignment="Center" Margin="15,0,0,0" Checked="ChkOverrideMap_Changed" Unchecked="ChkOverrideMap_Changed" IsChecked="True"/>
                </StackPanel>

                <TextBox Grid.Row="14" x:Name="txtLog" IsReadOnly="True" TextWrapping="Wrap" VerticalScrollBarVisibility="Auto" Background="#FFF5F5F5" FontFamily="Consolas" Padding="5"/>
            </Grid>

            <Border Grid.Column="3" Background="#FF222222" BorderBrush="Black" BorderThickness="1" Margin="0,20,20,20" ClipToBounds="True">
                <Grid>
                    <Viewport3D x:Name="viewport3D"
                            MouseLeftButtonDown="Viewport_MouseDown" 
                            MouseLeftButtonUp="Viewport_MouseUp" 
                            MouseMove="Viewport_MouseMove" 
                            MouseWheel="Viewport_MouseWheel">
                        <Viewport3D.Camera>
                            <PerspectiveCamera x:Name="cameraPreview" FieldOfView="60" />
                        </Viewport3D.Camera>
                        <ModelVisual3D>
                            <ModelVisual3D.Content>
                                <Model3DGroup x:Name="modelGroup">
                                    <AmbientLight Color="#FF404040"/>
                                    <DirectionalLight Color="#FFFFFFFF" Direction="-1,-1,-1" />
                                </Model3DGroup>
                            </ModelVisual3D.Content>
                        </ModelVisual3D>
                    </Viewport3D>

                    <Border HorizontalAlignment="Left" VerticalAlignment="Top" Margin="10" Background="#99000000" Padding="6,4" CornerRadius="3">
                        <CheckBox x:Name="chkWireframe" Content="Wireframe" Foreground="White" Background="White" BorderBrush="White" VerticalContentAlignment="Center" IsChecked="True" Checked="ChkWireframe_Changed" Unchecked="ChkWireframe_Changed"/>
                    </Border>
                </Grid>
            </Border>
        </Grid>
    </DockPanel>
</Window>